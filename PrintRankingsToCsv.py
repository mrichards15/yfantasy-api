from yfantasy_api.api import YahooFantasyApi
from TradeAnalyzer import get_league, get_team_rank, get_player_rank
import csv
from datetime import datetime

team = [
"Connor McDavid",
"Leon Draisaitl",
"Nikita Kucherov",
"David Pastrnak",
"Erik Karlsson",
"Jason Robertson",
"Tage Thompson",
"Mikko Rantanen",
"Matthew Tkachuk",
"Jack Hughes",
"Kyle Connor",
"Mitch Marner",
"Ryan Nugent-Hopkins",
"Alex Ovechkin",
"Kirill Kaprizov",
"Sidney Crosby",
"Steven Stamkos",
"Elias Pettersson",
"William Nylander",
"Zach Hyman",
"Bo Horvat",
"Auston Matthews",
"Pierre-Luc Dubois",
"Nathan MacKinnon",
"Josh Morrissey",
"Travis Konecny",
"Rasmus Dahlin",
"Brayden Point",
"Alex Tuch",
"Kevin Fiala",
"Artemi Panarin",
"Timo Meier",
"Mika Zibanejad",
"Brady Tkachuk",
"John Tavares",
"Jesper Bratt",
"Adam Fox",
"Roope Hintz",
"Mats Zuccarello",
"Evgeni Malkin",
"Joe Pavelski",
"Nico Hischier",
"Jeff Skinner",
"Cale Makar",
"Jordan Kyrou",
"Tim Stutzle",
"Brad Marchand",
"Tomas Hertl",
"Elias Lindholm",
"Johnny Gaudreau",
"Mathew Barzal",
"Jamie Benn",
"J.T. Miller",
"Dylan Larkin",
"Drake Batherson",
"Dylan Cozens",
"Kevin Hayes",
"Chandler Stephenson",
"Robert Thomas",
"Quinn Hughes",
"Mark Scheifele",
"Filip Forsberg",
"Jake Guentzel",
"Andrei Kuzmenko",
"Martin Necas",
"Alex DeBrincat",
"Claude Giroux",
"Brock Nelson",
"Brandon Hagel",
"Mark Stone",
"Tyler Toffoli",
"Clayton Keller",
"Dougie Hamilton",
"Nick Suzuki",
"Jakub Vrana",
"Pavel Buchnevich",
"Sebastian Aho",
"Aleksander Barkov",
"Andre Burakovsky",
"Brandon Montour",
"Evgeny Kuznetsov",
"Cole Caufield",
"Carter Verhaeghe",
"Matty Beniers",
"Logan Couture",
"Roman Josi",
"Troy Terry",
"Miro Heiskanen",
"Andrei Svechnikov",
"Nazem Kadri",
"Patrice Bergeron",
"Trevor Zegras",
"Anze Kopitar",
"David Krejci",
"Anthony Cirelli",
"Jordan Eberle",
"Joel Eriksson Ek",
"Matt Duchene",
"Anthony Duclair",
"Jack Eichel",
"Phillip Danault",
"Viktor Arvidsson",
"Brayden Schenn",
"Luke Schenn",
"Vince Dunn",
"Alex Killorn",
"Artturi Lehkonen",
"Dylan Strome",
"Tyson Barrie",
"Gabriel Vilardi",
"Michael Bunting",
"Dominik Kubalik",
"Sam Reinhart",
"Vincent Trocheck",
"Tyler Seguin",
"Jonathan Huberdeau",
"Filip Hronek",
"Mikhail Sergachev",
"Jared McCann",
"Chris Kreider",
"Adrian Kempe",
"Jake DeBrusk",
"Rickard Rakell",
"Anders Lee",
"David Perron",
"Max Domi",
"Taylor Hall",
"Lucas Raymond",
"Blake Wheeler",
"William Karlsson",
"Rasmus Andersson",
"Reilly Smith",
"Jonathan Marchessault",
"Matt Boldy",
"Jason Zucker",
"Vladimir Tarasenko",
"Gabriel Landeskog",
"Kirby Dach",
"Pavel Zacha",
"Brent Burns",
"Yanni Gourde",
"Hampus Lindholm",
"Daniel Sprong",
"Ivan Provorov",
"Conor Sheary",
"Sam Bennett",
"J.T. Compher",
"Shayne Gostisbehere",
"Patrick Kane",
"Evander Kane",
"Alexander Barabanov",
"Gustav Forsling",
"Alex Pietrangelo",
"Victor Hedman",
"Lawson Crouse",
"Scott Laughton",
"Noah Dobson",
"Dawson Mercer",
"Jean-Gabriel Pageau",
"Bryan Rust",
"Tomas Tatar",
"Tom Wilson",
"Mason McTavish",
"Drew Doughty",
"Charlie McAvoy",
"Ilya Mikheyev",
"Brock Boeser",
"Tony DeAngelo",
"Esa Lindell",
"Erik Gustafsson",
"Casey Mittelstadt",
"Cole Perfetti",
"Nick Paul",
"Adam Henrique",
"Jonathan Toews",
"Nicklas Backstrom",
"John Klingberg",
"Charlie Coyle",
"Kevin Labanc",
"Joel Farabee",
"Thomas Chabot",
"Andrew Copp",
"Mikael Granlund",
"Devon Toews",
"Victor Olofsson",
"Owen Tippett",
"Filip Chytil",
"Mikael Backlund",
"Sean Durzi",
"Justin Schultz",
"Jack Roslovic",
"Nino Niederreiter",
"Dillon Dube",
"Evan Rodrigues",
"Jaden Schwartz",
"Ryan Strome",
"Anthony Mantha",
"Adam Lowry",
"Jakob Chychrun",
"Patrik Laine",
"Boone Jenner",
"Marcus Johansson",
"Ryan Johansen",
"Jordan Martinook",
"Mason Marchment",
"Sam Steel",
"Brandon Tanev",
"Alexander Wennberg",
"Oliver Bjorkstrand",
"Seth Jarvis",
"Bowen Byram",
"Sean Couturier",
"Justin Faulk",
"Shea Theodore",
"Calen Addison",
"Matias Maccelli",
"Frederick Gaudreau",
"Yegor Sharangovich",
"Morgan Frost",
"Barclay Goodrow",
"Calle Jarnkrok",
"Andrew Mangiapane",
"John Carlson",
"Conor Garland",
"Stefan Noesen",
"Nick Schmaltz",
"Jared Spurgeon",
"Darnell Nurse",
"Zach Parise",
"Taylor Raddysh",
"Nick Bjugstad",
"Kaapo Kakko",
"Eetu Luostarinen",
"Gustav Nyquist",
"Brady Skjei",
"Christian Dvorak",
"Aaron Ekblad",
"Alexander Kerfoot",
"Sonny Milano",
"Michael Rasmussen",
"Ivan Barbashev",
"Dmitry Orlov",
"Adam Ruzicka",
"Adam Larsson",
"Erik Haula",
"Moritz Seider",
"Matt Benning",
"Morgan Rielly",
"Jordan Staal",
"Nic Dowd",
"Arthur Kaliyev",
"Kent Johnson",
"Jeff Carter",
"Blake Lizotte",
"Trevor Moore",
"Jeff Petry",
"Neal Pionk",
"Jack Quinn",
"James van Riemsdyk",
"Ty Dellandrea",
"Nick Foligno",
"Cam Fowler",
"Seth Jones",
"Oliver Ekman-Larsson",
"Brandon Saad",
"Wyatt Johnston",
"Shane Pinto",
"Noel Acciari",
"Trent Frederic",
"Anthony Beauvillier",
"Ross Colton",
"Blake Coleman",
"Nick Ritchie",
"Nicolas Roy",
"Phil Kessel",
"JJ Peterka",
"Frank Vatrano",
"Josh Bailey",
"Philipp Kurashev",
"Alexis Lafreniere",
"J.J. Moser",
"Juuso Parssinen",
"Michael McLeod",
"Brett Pesce",
"Evan Bouchard",
"Teuvo Teravainen",
"Alex Iafallo",
"Valeri Nichushkin",
"Kyle Okposo",
"Kasperi Kapanen",
"Anton Lundell",
"Sean Monahan",
"Jacob Trouba",
"Noah Cates",
"Torey Krug",
"Owen Power",
"Noah Hanifin",
"William Carrier",
"Pierre Engvall",
"Jaccob Slavin",
"Alex Newhook",
"T.J. Oshie",
"Jonatan Berggren",
"Tanner Jeannot",
"Jesperi Kotkaniemi",
"Oliver Wahlstrom",
"Miles Wood",
"Corey Perry",
"Ryan Ellis",
"MacKenzie Weegar",
"Oskar Sundqvist",
"Jesper Fast",
"Mark Giordano",
"Kevin Shattenkirk",
"Jonas Siegenthaler",
"Brayden McNabb",
"Nick Jensen",
"Scott Mayfield",
"Ryan Pulock",
"Connor Clifton",
"Matt Dumba",
"Ty Smith",
"Josh Manson",
"Jake Muzzin",
"Alexander Romanov",
"Ian Cole",
"Ryan Lindgren",
"Nikita Zadorov",
"Arber Xhekaj",
"Travis Sanheim",
"Damon Severson",
"Colton Parayko",
"Ryan Graves",
"Mattias Ekholm",
"Ryan Hartman",
"Matt Roy",
"Matt Grzelcyk",
"Kris Letang",
"Josh Norris",
"Jake Sanderson",
"Josh Anderson",
"Jake Allen",
"Frederik Andersen",
"Craig Anderson",
"Jordan Binnington",
"MacKenzie Blackwood",
"Sergei Bobrovsky",
"Jack Campbell",
"Eric Comrie",
"Pheonix Copley",
"Collin Delia",
"Aaron Dell",
"Thatcher Demko",
"Casey DeSmith",
"Brian Elliott",
"Marc-Andre Fleury",
"Anton Forsberg",
"Pavel Francouz",
"Alexandar Georgiev",
"John Gibson",
"Thomas Greiss",
"Philipp Grubauer",
"Filip Gustavsson",
"Jaroslav Halak",
"Carter Hart",
"Connor Hellebuyck",
"Adin Hill",
"Ville Husso",
"Connor Ingram",
"Robin Lehner",
"Tristan Jarry",
"Jonas Johansson",
"Martin Jones",
"Kaapo Kahkonen",
"Erik Kallgren",
"Keith Kinkaid",
"Spencer Knight",
"Pyotr Kochetkov",
"Joonas Korpisalo",
"Darcy Kuemper",
"Kevin Lankinen",
"Charlie Lindgren",
"Ukko-Pekka Luukkonen",
"Jacob Markstrom",
"Spencer Martin",
"Elvis Merzlikins",
"Sam Montembeault",
"Petr Mrazek",
"Matt Murray",
"Alex Nedeljkovic",
"Jake Oettinger",
"Calvin Petersen",
"Jonathan Quick",
"Antti Raanta",
"James Reimer",
"David Rittich",
"Ilya Samsonov",
"Felix Sandstrom",
"Juuse Saros",
"Akira Schmid",
"Igor Shesterkin",
"Stuart Skinner",
"Ilya Sorokin",
"Jeremy Swayman",
"Cam Talbot",
"Daniil Tarasov",
"Logan Thompson",
"Dustin Tokarski",
"Linus Ullmark",
"Vitek Vanecek",
"Semyon Varlamov",
"Andrei Vasilevskiy",
"Karel Vejmelka",
"Daniel Vladar",
]

def PrintRankings():
    print(f'\n\n\n\n\n\n')
    print("STARTING PROCESSING TO CSV")

    time = datetime.today().strftime('%Y-%m-%d-%S')
    fileName = './rankings/PlayersRichValRankings-' + time + '.csv'

    outfile = open(fileName,'w')
    writer=csv.writer(outfile)
    writer.writerow(['Player', 'Position', 'PreVORP', 'RichVal'])

    for player_name in team:
        get_player_rank(player_name, "CSV", writer)

    print("CSV HAS BEEN PROCESSED")
    print(f'\n\n\n\n\n\n')

    return fileName

PrintRankings()